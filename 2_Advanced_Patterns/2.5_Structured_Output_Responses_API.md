# 2.5 OpenAI Responses API & Structured Output (Concepts)

- Use **structured outputs** to enforce schemas (JSON mode / schema). Pair with explicit format examples for reliability; combine with `reasoning_effort` when tasks require deeper analysis. [O2][O3]

```typescript
# Structured response constraints (conceptual)
Schema fields: {entity, type, span, source_id}
Constraints: return JSON array only; no prose; cite source_id for each entity.
```

## Key Concepts

### Structured Outputs
- **Schema enforcement**: Define exact JSON structure required
- **Type validation**: Ensure fields match expected data types
- **Required fields**: Specify which fields must be present
- **Array handling**: Define array structures and constraints

### Responses API Integration
- **Persistent state**: Maintain context across tool calls
- **Multi-turn reasoning**: Complex workflows with memory
- **Tool orchestration**: Coordinate multiple tool interactions
- **State management**: Track progress through multi-step processes

## Implementation Patterns

### Basic Structured Output
```typescript
{
  "type": "object",
  "properties": {
    "entity": {"type": "string"},
    "category": {"type": "string", "enum": ["person", "organization", "location"]},
    "confidence": {"type": "number", "minimum": 0, "maximum": 1},
    "source_id": {"type": "string"}
  },
  "required": ["entity", "category", "source_id"]
}
```

### Combined with reasoning_effort
```typescript
# For complex analysis requiring structured output
- reasoning_effort: medium  # Balance depth with performance
- schema: {entity, analysis, confidence, citations}
- validation: strict type checking + required fields
- output_constraints: JSON only, no additional prose
```

## Best Practices

1. **Define clear schemas**: Specify exact structure and types
2. **Use format examples**: Show expected output alongside schema
3. **Validate strictly**: Enforce required fields and types
4. **Combine with reasoning**: Use reasoning_effort for complex structured tasks
5. **Handle arrays properly**: Define array item schemas clearly